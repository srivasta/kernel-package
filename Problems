
    $Id: Problems,v 1.3 1997/09/18 04:59:24 srivasta Exp $

 This is an (incomplete) list of problems that people have encountered
 in the past while using kernel-package. Please remember to configure
 the kernel for your machine using make menuconfig, and to clean the
 source tree before compiling a new image using make-kpkg clean.

 a) Failure to format a floppy disk while installing kernel image.

    fdformat from the obsolete package miscutils sometimes has problems 
    formatting floppies.  Install the package fdutils instead.
    Also, sometimes the new fdformat fails for /dev/fd0 unless the
    parameters are set using setfdprm -- in short, make sure that you can
    format floppies manually before asking the kernel image postinst to do
    so.

 b) warning, 'debian/tmp-image/DEBIAN/control' contains user-defined field
   'Installed-Size'warning,
    dpkg-deb: unable to create  '..': is a directory

    The problem is actually that the version of dpkg being used is
     too old for kernel-package; kernel-package version 3.X needs dpkg
     1.4.0.0 at least.

 c) dpkg-gencontrol fails with the error message 
    failure: chown new files list file: Illegal seek

    This is an error in older versions of dpkg-dev. Upgrading to version
    1.4.0.9 should help.

 d) install: debian/changelog: No such file or directory
   
     Remember to do make-kpkg clean with a patched/old kernel source tree
     (if this is not a clean tree, clean it first).

 e) make-kpkg goes into an infinite loop when trying to make oldconfig.

    This is _not_ a bug with kernel-package, it is a well known
    incompatibility between the new version of expr (which has suddenly
    become POSIX compliant) and the kernel sources (which did not expect
    expr to behave this way).

    The fix is to apply the following patch to the kernel sources. 


--- scripts/Configure.dist	Mon Jan 20 14:43:24 1997
+++ scripts/Configure	Tue Jan 21 05:41:30 1997
@@ -288,7 +288,7 @@
 	def=${old:-$3}
 	while :; do
 	  readln "$1 ($2) [$def] " "$def" "$old"
-	  if expr "$ans" : '0$\|-?[1-9][0-9]*$' > /dev/null; then
+	  if expr "$ans" : '0$\|-\?[1-9][0-9]*$' > /dev/null; then
 	    define_int "$2" "$ans"
 	    break
 	  else
@@ -319,7 +319,7 @@
 	while :; do
 	  readln "$1 ($2) [$def] " "$def" "$old"
 	  ans=${ans#*[x,X]}
-	 if expr "$ans" : '[0-9a-fA-F]+$' > /dev/null; then
+	 if expr "$ans" : '[0-9a-fA-F]\+$' > /dev/null; then
 	   define_hex "$2" "$ans"
 	   break
 	 else


  f) % depmod -a
     modprobe: error reading ELF header: No such file or directory


     This is a problem with the newly changed behavior of depmod and
     friends, who suddenly stopped liking non .o files in
     /lib/modules/<version>. Newer versions of kernel package, like this
     one, handle that right. For older image packages, the test is:

     % find /lib/modules/2.0.30/ -type f -exec file {} \; | grep -v 'ELF 32-bit'
     /lib/modules/2.0.30/modules.dep: ASCII text

     Anything other than modules.dep showing up is something that depmod
     can no longer tolerate. Remove those files, and things should be fine.
